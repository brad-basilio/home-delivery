import{j as p}from"./FileViewer-CpM0iYLI.js";import{r as e}from"./index-B80Lgev0.js";import{a as l}from"./axios-B4uVmeYG.js";const L=e.createContext(),v=({children:i})=>{const[t,u]=e.useState(()=>{try{const r=localStorage.getItem("currentLanguage");return r?r.startsWith("U2FsdGVkX1")?(localStorage.removeItem("currentLanguage"),null):JSON.parse(r):null}catch(r){return console.warn("Error parsing currentLanguage data, clearing localStorage:",r),localStorage.removeItem("currentLanguage"),null}}),[g,m]=e.useState({}),[d,n]=e.useState(!1),[f,s]=e.useState(null),c=e.useCallback(async(r,o)=>{try{n(!0),s(null);const a=await l.get(`/api/translations/${r}`,{signal:o});m(a.data)}catch(a){l.isCancel(a)||(console.error("Error loading translations:",a),s(a.message))}finally{n(!1)}},[]);e.useEffect(()=>{if(!(t!=null&&t.id))return;const r=new AbortController;return c(t.id,r.signal),()=>r.abort()},[t==null?void 0:t.id,c]);const S=async r=>{try{if(!(r!=null&&r.id)||!(r!=null&&r.name))throw new Error("Invalid language object");localStorage.setItem("currentLanguage",JSON.stringify(r)),u(r)}catch(o){console.error("Error changing language:",o),s(o.message)}};return p.jsx(L.Provider,{value:{currentLanguage:t,changeLanguage:S,translations:g,loading:d,error:f},children:i})};export{v as L,L as a};
