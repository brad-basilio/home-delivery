var N=Object.defineProperty;var u=(a,c,s)=>c in a?N(a,c,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[c]=s;var x=(a,c,s)=>(u(a,typeof c!="symbol"?c+"":c,s),s);import{j as e}from"./FileViewer-DkaHswXt.js";import{r as t}from"./TrackingPixels-B80Lgev0.js";import{c as g}from"./ReactAppend-CY8yKZvG.js";import{B as f}from"./Base-BYX3oziu.js";import{C as b}from"./CreateReactScript-BEktg6JA.js";import{T as v}from"./Table-Dhu2mzRt.js";import{D as h}from"./DxButton-CsjWvhyj.js";import{R as n}from"./ReactAppend-Yu2UtNlL.js";import{B as w}from"./Results-D258VEiO.js";import{M as y}from"./Modal-CJBbhQ-7.js";import{S}from"./sweetalert2.all-C96erxsa.js";import"./index-CbrplguO.js";import"./tippy-react.esm-CIcmk6y-.js";/* empty css              */import"./Logout-CHcSRTk-.js";import"./main-D1ujSG59.js";import"./___vite-browser-external_commonjs-proxy-DjIx6Adb.js";import"./index.esm-Duzu12F9.js";import"./axios-B4uVmeYG.js";import"./useTranslation-BOupZ7-X.js";import"./Filter-BZ5YA63n.js";/* empty css               */class C extends w{constructor(){super(...arguments);x(this,"path","admin/messages")}}const m=new C,R=()=>{var d;const a=t.useRef(),c=t.useRef(),[s,p]=t.useState(null),j=async i=>{const{isConfirmed:l}=await S.fire({title:"Eliminar mensaje",text:"¿Estas seguro de eliminar este mensaje?",icon:"warning",showCancelButton:!0,confirmButtonText:"Si, eliminar",cancelButtonText:"Cancelar"});!l||!await m.delete(i)||$(a.current).dxDataGrid("instance").refresh()},o=i=>{i.seen||(m.boolean({id:i,field:"seen",value:!0}),$(a.current).dxDataGrid("instance").refresh()),p(i),$(c.current).modal("show")};return e.jsxs(e.Fragment,{children:[e.jsx(v,{gridRef:a,title:"Mensajes",rest:m,toolBar:i=>{i.unshift({widget:"dxButton",location:"after",options:{icon:"refresh",hint:"Refrescar tabla",onClick:()=>$(a.current).dxDataGrid("instance").refresh()}})},columns:[{dataField:"id",caption:"ID",visible:!1},{dataField:"name",caption:"Nombre",cellTemplate:(i,{data:l})=>{n(i,e.jsx("span",{style:{width:"100%",fontWeight:l.seen?"lighter":"bold",cursor:"pointer"},onClick:()=>o(l),children:l.name}))}},{dataField:"email",caption:"Correo"},{dataField:"service.title",caption:"Servicio",cellTemplate:(i,{data:l})=>{var r;n(i,e.jsx("span",{children:((r=l.service)==null?void 0:r.title)||e.jsx("i",{className:"text-muted",children:"- Consulta General -"})}))}},{dataField:"company",caption:"Empresa",cellTemplate:(i,{data:l})=>{n(i,e.jsx("span",{children:l.company||e.jsx("i",{className:"text-muted",children:"-"})}))}},{dataField:"phone",caption:"Teléfono",cellTemplate:(i,{data:l})=>{n(i,e.jsx("span",{children:l.phone||e.jsx("i",{className:"text-muted",children:"-"})}))}},{dataField:"created_at",caption:"Fecha",dataType:"datetime",format:"yyyy-MM-dd HH:mm:ss",sortOrder:"desc"},{dataField:"status",caption:"Estado",dataType:"boolean",cellTemplate:(i,{data:l})=>{l.seen?n(i,e.jsx("span",{className:"badge bg-success rounded-pill",children:"Leído"})):n(i,e.jsx("span",{className:"badge bg-danger rounded-pill",children:"No leído"}))}},{caption:"Acciones",cellTemplate:(i,{data:l})=>{i.append(h({className:"btn btn-xs btn-soft-dark",title:"Ver mensaje",icon:"fa fa-eye",onClick:()=>o(l)})),i.append(h({className:"btn btn-xs btn-soft-danger",title:"Eliminar",icon:"fa fa-trash",onClick:()=>j(l.id)}))},allowFiltering:!1,allowExporting:!1}]}),e.jsx(y,{modalRef:c,title:"Detalle del Mensaje",hideFooter:!0,size:"lg",children:e.jsxs("div",{className:"row g-3",children:[e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"bg-light p-3 rounded",children:[e.jsxs("h6",{className:"text-primary mb-3",children:[e.jsx("i",{className:"mdi mdi-account-circle me-2"}),"Información del Cliente"]}),e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Nombre:"}),e.jsx("span",{className:"ms-2",children:s==null?void 0:s.name})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Correo:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.email)||e.jsx("i",{className:"text-muted",children:"- Sin correo -"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Teléfono:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.phone)||e.jsx("i",{className:"text-muted",children:"- Sin teléfono -"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Empresa:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.company)||e.jsx("i",{className:"text-muted",children:"- Sin empresa -"})})]})})]})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"bg-light p-3 rounded",children:[e.jsxs("h6",{className:"text-success mb-3",children:[e.jsx("i",{className:"mdi mdi-package-variant me-2"}),"Detalles de la Solicitud"]}),e.jsxs("div",{className:"row g-2",children:[e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Rubro:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.business_sector)||e.jsx("i",{className:"text-muted",children:"- Sin rubro -"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Envíos diarios/mensuales:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.daily_shipments)||e.jsx("i",{className:"text-muted",children:"- Sin especificar -"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Ubicación:"}),e.jsx("span",{className:"ms-2",children:(s==null?void 0:s.location_type)||e.jsx("i",{className:"text-muted",children:"- Sin especificar -"})})]})}),e.jsx("div",{className:"col-md-6",children:e.jsxs("p",{className:"mb-2",children:[e.jsx("strong",{children:"Servicio:"}),e.jsx("span",{className:"ms-2",children:((d=s==null?void 0:s.service)==null?void 0:d.title)||e.jsx("span",{className:"badge bg-info",children:"Consulta General"})})]})})]})]})}),(s==null?void 0:s.subject)&&e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"bg-light p-3 rounded",children:[e.jsxs("h6",{className:"text-warning mb-2",children:[e.jsx("i",{className:"mdi mdi-email-outline me-2"}),"Asunto"]}),e.jsx("p",{className:"mb-0",children:s.subject})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"bg-light p-3 rounded",children:[e.jsxs("h6",{className:"text-info mb-2",children:[e.jsx("i",{className:"mdi mdi-message-text me-2"}),"Mensaje"]}),e.jsx("div",{className:"p-2 bg-white rounded",style:{whiteSpace:"pre-line"},children:s==null?void 0:s.description})]})}),e.jsx("div",{className:"col-12",children:e.jsxs("div",{className:"d-flex justify-content-between align-items-center text-muted small",children:[e.jsxs("span",{children:[e.jsx("i",{className:"mdi mdi-clock-outline me-1"}),"Recibido: ",s!=null&&s.created_at?new Date(s.created_at).toLocaleString("es-PE"):"-"]}),e.jsx("span",{children:s!=null&&s.seen?e.jsxs("span",{className:"badge bg-success",children:[e.jsx("i",{className:"mdi mdi-check-all me-1"}),"Leído"]}):e.jsxs("span",{className:"badge bg-danger",children:[e.jsx("i",{className:"mdi mdi-email-alert me-1"}),"No leído"]})})]})})]})})]})};b((a,c)=>{g(a).render(e.jsx(f,{...c,title:"Mensajes",children:e.jsx(R,{...c})}))});
